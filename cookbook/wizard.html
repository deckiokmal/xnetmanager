<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wizard Konfigurasi MikroTik</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .step {
            display: none;
        }

        .step.active {
            display: block;
        }
    </style>
</head>

<body>
    <div class="container mt-5">
        <div class="card">
            <div class="card-header text-center">
                <h4>Wizard Konfigurasi MikroTik</h4>
            </div>
            <div class="card-body">
                <!-- Progress Bar -->
                <div class="progress mb-4">
                    <div id="progress-bar" class="progress-bar" style="width: 20%">Step 1</div>
                </div>

                <!-- Step 1: Pilih Vendor -->
                <div class="step active" id="step-1">
                    <h5>Pilih Jenis Perangkat</h5>
                    <select class="form-control" id="device-type">
                        <option value="mikrotik">MikroTik</option>
                    </select>
                    <div class="mt-3 text-end">
                        <button class="btn btn-primary" onclick="nextStep(2)">Next</button>
                    </div>
                </div>

                <!-- Step 2: Intent Input -->
                <div class="step" id="step-2">
                    <h5>Masukkan Deskripsi Konfigurasi</h5>
                    <textarea class="form-control" id="intent-input" rows="3"
                        placeholder="Contoh: Saya ingin mengatur IP statis, DHCP, dan NAT..."></textarea>
                    <div class="mt-3 text-end">
                        <button class="btn btn-secondary" onclick="prevStep(1)">Back</button>
                        <button class="btn btn-primary" onclick="nextStep(3)">Next</button>
                    </div>
                </div>

                <!-- Step 3: Konfigurasi Dasar -->
                <div class="step" id="step-3">
                    <h5>Konfigurasi Jaringan Dasar</h5>
                    <label>IP Address WAN:</label>
                    <input type="text" class="form-control mb-2" id="ip-wan">
                    <label>IP Local:</label>
                    <input type="text" class="form-control mb-2" id="ip-local">
                    <label>IP Gateway:</label>
                    <input type="text" class="form-control mb-2" id="ip-gateway">
                    <label>DNS Server:</label>
                    <input type="text" class="form-control mb-2" id="dns-server">
                    <label>Alternatif DNS Server:</label>
                    <input type="text" class="form-control mb-2" id="alternatif-dns-server">
                    <div class="mt-3 text-end">
                        <button class="btn btn-secondary" onclick="prevStep(2)">Back</button>
                        <button class="btn btn-primary" onclick="nextStep(4)">Next</button>
                    </div>
                </div>

                <!-- Step 4: DHCP, NAT, Firewall -->
                <div class="step" id="step-4">
                    <h5>Konfigurasi DHCP, NAT, dan Firewall</h5>
                    <h5>Konfigurasi DHCP Server</h5>

                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="enable-dhcp" onchange="toggleDHCP()">
                        <label class="form-check-label" for="enable-dhcp">Aktifkan DHCP Server</label>
                    </div>

                    <div id="dhcp-options" class="mt-2" style="display: none;">
                        <label>Interface:</label>
                        <input type="text" class="form-control mb-2" id="dhcp-interface" placeholder="contoh: bridge1">
                        <label>IP Range:</label>
                        <input type="text" class="form-control mb-2" id="dhcp-range"
                            placeholder="contoh: 192.168.1.100-192.168.1.200">
                        <label>Gateway:</label>
                        <input type="text" class="form-control mb-2" id="dhcp-gateway"
                            placeholder="contoh: 192.168.1.1">
                        <label>DNS Server (Opsional):</label>
                        <input type="text" class="form-control mb-2" id="dhcp-dns" placeholder="contoh: 8.8.8.8">
                        <label>Lease Time:</label>
                        <input type="text" class="form-control mb-2" id="dhcp-lease" placeholder="contoh: 10m">
                    </div>

                    <h5>Pilih Tipe NAT</h5>

                    <!-- NAT Internet (Masquerade) -->
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="nat-internet"
                            onchange="toggleNatOptions('internet')">
                        <label class="form-check-label" for="nat-internet">NAT Internet (Masquerade)</label>
                    </div>
                    <div id="nat-internet-options" class="nat-options mt-2" style="display: none;">
                        <label>Out-Interface:</label>
                        <input type="text" class="form-control mb-2" id="nat-out-interface"
                            placeholder="contoh: ether1">
                        <label>Src-Address (Opsional):</label>
                        <input type="text" class="form-control mb-2" id="nat-src-address"
                            placeholder="contoh: 192.168.1.0/24">
                    </div>

                    <!-- Port Forwarding (DNAT) -->
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="nat-portforward"
                            onchange="toggleNatOptions('portforward')">
                        <label class="form-check-label" for="nat-portforward">Port Forwarding (DNAT)</label>
                    </div>
                    <div id="nat-portforward-options" class="nat-options mt-2" style="display: none;">
                        <label>Dst-Port:</label>
                        <input type="text" class="form-control mb-2" id="nat-dst-port" placeholder="contoh: 80">
                        <label>To-Address:</label>
                        <input type="text" class="form-control mb-2" id="nat-to-address"
                            placeholder="contoh: 192.168.1.100">
                        <label>To-Port (Opsional):</label>
                        <input type="text" class="form-control mb-2" id="nat-to-port" placeholder="contoh: 8080">
                    </div>

                    <!-- Hairpin NAT -->
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="nat-hairpin"
                            onchange="toggleNatOptions('hairpin')">
                        <label class="form-check-label" for="nat-hairpin">Hairpin NAT</label>
                    </div>
                    <div id="nat-hairpin-options" class="nat-options mt-2" style="display: none;">
                        <label>Dst-Address (Public IP):</label>
                        <input type="text" class="form-control mb-2" id="nat-hairpin-dst"
                            placeholder="contoh: 203.0.113.1">
                        <label>To-Address (Internal Server IP):</label>
                        <input type="text" class="form-control mb-2" id="nat-hairpin-to"
                            placeholder="contoh: 192.168.1.100">
                    </div>

                    <!-- Static NAT -->
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="nat-static"
                            onchange="toggleNatOptions('static')">
                        <label class="form-check-label" for="nat-static">Static NAT (One-to-One NAT)</label>
                    </div>
                    <div id="nat-static-options" class="nat-options mt-2" style="display: none;">
                        <label>Src-Address:</label>
                        <input type="text" class="form-control mb-2" id="nat-static-src"
                            placeholder="contoh: 192.168.1.10">
                        <label>Dst-Address:</label>
                        <input type="text" class="form-control mb-2" id="nat-static-dst"
                            placeholder="contoh: 203.0.113.10">
                    </div>

                    <h5 class="mt-4">Firewall Rules (Best Practice)</h5>
                    <p>Pilih aturan firewall yang ingin diterapkan:</p>

                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="firewall-invalid">
                        <label class="form-check-label" for="firewall-invalid">Drop Invalid Packets</label>
                    </div>

                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="firewall-icmp">
                        <label class="form-check-label" for="firewall-icmp">Drop ICMP Flood Attack</label>
                    </div>

                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="firewall-wan-lan">
                        <label class="form-check-label" for="firewall-wan-lan">Block WAN to LAN</label>
                    </div>

                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="firewall-established">
                        <label class="form-check-label" for="firewall-established">Allow Established & Related
                            Connections</label>
                    </div>

                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="firewall-internal">
                        <label class="form-check-label" for="firewall-internal">Allow Internal LAN Access</label>
                    </div>

                    <button class="btn btn-secondary" onclick="prevStep(3)">Back</button>
                    <button class="btn btn-primary" onclick="nextStep(5)">Next</button>
                </div>
            </div>

            <!-- Step 5: Validasi & Konfirmasi -->
            <div class="step" id="step-5">
                <h5>Validasi & Konfirmasi</h5>
                <pre id="config-preview" class="border p-3"></pre>
                <div class="mt-3 text-end">
                    <button class="btn btn-secondary" onclick="prevStep(4)">Back</button>
                    <button class="btn btn-success" onclick="saveConfig()">Simpan</button>
                </div>
            </div>

            <!-- Step 6: Selesai -->
            <div class="step" id="step-6">
                <h5>Konfigurasi Berhasil Disimpan</h5>
                <p>Anda dapat mengunduh script atau kembali ke dashboard.</p>
                <div class="mt-3 text-end">
                    <button class="btn btn-primary" onclick="downloadConfig()">Download Script</button>
                    <button class="btn btn-secondary" onclick="location.reload()">Selesai</button>
                </div>
            </div>
        </div>
    </div>
    </div>

    <script>
        let currentStep = 1;

        function nextStep(step) {
            document.getElementById(`step-${currentStep}`).classList.remove('active');
            document.getElementById(`step-${step}`).classList.add('active');
            currentStep = step;
            updateProgressBar();
        }

        function prevStep(step) {
            document.getElementById(`step-${currentStep}`).classList.remove('active');
            document.getElementById(`step-${step}`).classList.add('active');
            currentStep = step;
            updateProgressBar();
        }

        function updateProgressBar() {
            const progress = (currentStep - 1) * 20;
            document.getElementById('progress-bar').style.width = `${progress}%`;
            document.getElementById('progress-bar').textContent = `Step ${currentStep}`;
        }

        function saveConfig() {
            document.getElementById('config-preview').textContent = "Konfigurasi berhasil dibuat dalam format Jinja2 & YAML.";
            nextStep(6);
        }

        function downloadConfig() {
            alert("File konfigurasi siap diunduh.");
        }

        function toggleDHCP() {
            const dhcpDiv = document.getElementById("dhcp-options");
            const checkbox = document.getElementById("enable-dhcp");

            if (checkbox.checked) {
                dhcpDiv.style.display = "block";
            } else {
                dhcpDiv.style.display = "none";
            }
        }

        function toggleNatOptions(type) {
            const optionsDiv = document.getElementById(`nat-${type}-options`);
            const checkbox = document.getElementById(`nat-${type}`);

            if (checkbox.checked) {
                optionsDiv.style.display = "block";
            } else {
                optionsDiv.style.display = "none";
            }
        }
    </script>
</body>

</html>