ltm policy web_traffic_vulnerability {
    controls { forwarding }
    requires { http }
    rules {
        block_sql_injection {
            actions {
                0 {
                    asm
                    disable
                }
                10 {
                    http
                    path
                    value detect_select_from_where_expression
                }
                20 {
                    asm
                    enable
                }
                30 {
                    forward
                    select pool web_pool
                }
            }
            conditions {
                0 {
                    http-method
                    values { PUT POST PATCH }
                }
                1 {
                    http-uri
                    path
                    values { *.php *.html *.js }
                }
            }
        }
        block_command_injection {
            actions {
                0 {
                    asm
                    disable
                }
                10 {
                    http
                    path
                    value detect_cmd_injection_expression
                }
                20 {
                    asm
                    enable
                }
                30 {
                    forward
                    select pool web_pool
                }
            }
            conditions {
                0 {
                    http-method
                    values { PUT POST PATCH }
                }
                1 {
                    http-uri
                    path
                    values { *.php *.html *.js }
                }
            }
        }
        block_cross_site_scripting {
            actions {
                0 {
                    asm
                    disable
                }
                10 {
                    http
                    path
                    value detect_xss_expression
                }
                20 {
                    asm
                    enable
                }
                30 {
                    forward
                    select pool web_pool
                }
            }
            conditions {
                0 {
                    http-method
                    values { PUT POST PATCH }
                }
                1 {
                    http-uri
                    path
                    values { *.php *.html *.js }
                }
            }
        }
    }
    strategy first-match
}